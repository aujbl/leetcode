# -*- coding: utf-8 -*-

"""
@author: jbl
@time: 2021/12/16 9:59
"""
from typing import List
import math
import bisect
 
class Solution:
    def visiblePoints(self, points: List[List[int]], angle: int, location: List[int]) -> int:
        angles = []
        loc_in_points = 0
        for px, py in points:
            if location == [px, py]:
                loc_in_points += 1
                continue
            angles.append((math.atan2(py - location[1], px - location[0]) * 180 / math.pi) % 360)
        angles.sort()
        res = 0

        for i in range(len(angles)):
            l = bisect.bisect_left(angles, angles[i])
            r = bisect.bisect_right(angles, (angles[i] + angle) % 360)
            if r <= l:
                r += len(angles)
            if loc_in_points > 0:
                r += loc_in_points
            res = max(res, r - l)
            # if angle == 0 and angles[i] != 0:
            #     res = max(res, r - l + 1)

        return res


if __name__ == '__main__':
    solution = Solution()
    points = [[2, 1], [2, 2], [3, 4], [1, 1]]
    angle = 90
    location = [1, 1]
    # points = [[2, 1], [2, 2], [3, 4], [1, 1]]
    # angle = 90
    # location = [1, 1]

    # points = [[1, 0], [2, 1]]
    # angle = 13
    # location = [1, 1]

    # points = [[1, 1], [2, 2], [3, 3], [4, 4], [1, 2], [2, 1]]
    # angle = 0
    # location = [1, 1]

    # points = [[60, 61], [58, 47], [17, 26], [87, 97], [63, 63], [26, 50], [70, 21], [3, 89], [51, 24], [55, 14], [6, 51],
    #  [64, 21], [66, 33], [54, 35], [87, 38], [30, 0], [37, 92], [92, 12], [60, 73], [75, 98], [1, 11], [88, 24],
    #  [82, 92]]
    # angle = 44
    # location = [15, 50]

    # points = [[65, 14], [94, 87], [17, 50], [70, 10], [69, 14], [38, 1], [4, 72], [8, 5], [5, 77], [97, 82], [89, 34], [70, 43],
    #  [15, 98], [66, 7], [39, 15], [21, 58], [8, 70], [41, 56], [36, 70], [79, 50], [3, 90], [90, 26], [36, 31],
    #  [12, 10], [98, 88], [26, 60], [3, 94], [0, 49], [61, 15], [73, 41], [28, 79], [10, 80], [47, 25], [74, 7], [94, 5],
    #  [70, 9], [28, 69], [92, 60], [61, 35], [17, 86], [60, 85], [53, 50], [41, 85], [26, 98], [54, 90], [26, 65],
    #  [100, 59], [47, 50], [76, 82], [48, 20], [68, 73], [40, 8], [49, 60], [92, 45], [83, 30], [59, 1], [54, 34],
    #  [68, 20], [21, 16], [48, 60], [61, 2], [0, 53], [9, 10], [7, 81], [4, 13], [42, 60], [68, 26], [63, 14], [26, 17],
    #  [52, 34], [58, 65], [74, 52], [83, 70], [98, 89], [53, 37], [39, 43], [83, 76], [58, 8], [50, 12], [4, 99],
    #  [98, 67], [72, 24], [91, 58], [49, 5], [46, 67], [22, 90], [100, 73], [50, 12], [16, 97], [41, 63], [72, 71],
    #  [71, 5], [30, 60], [77, 71], [5, 68], [43, 92], [46, 11], [76, 40], [60, 20], [30, 83], [63, 18], [45, 50],
    #  [50, 84], [32, 99], [15, 84], [77, 92], [16, 88], [36, 42], [13, 64], [91, 59], [19, 96], [3, 15], [93, 88],
    #  [83, 83], [61, 88], [21, 50], [61, 94], [77, 85], [74, 30], [43, 32], [88, 72], [32, 17], [89, 74], [60, 40],
    #  [5, 43], [30, 19], [0, 13], [54, 65], [98, 14], [49, 91], [77, 11], [42, 12], [96, 29], [65, 61], [45, 4], [3, 72],
    #  [46, 97], [33, 97], [92, 28], [0, 4], [62, 48], [94, 13], [1, 11], [28, 73], [50, 32], [47, 40], [28, 8], [90, 51],
    #  [24, 40], [56, 23], [38, 72], [12, 84], [14, 27], [91, 8], [21, 44], [55, 90], [42, 73], [86, 62], [4, 63],
    #  [24, 60], [12, 57], [90, 25], [50, 89], [1, 85], [63, 1], [68, 93], [76, 74], [80, 8], [55, 56], [85, 77],
    #  [87, 50], [98, 25], [78, 94], [26, 45], [91, 34], [89, 60]]
    # angle = 227
    # location = [60, 100]

    # points = [[79, 44], [85, 96], [53, 20], [63, 50], [54, 10], [21, 78], [65, 32], [30, 42], [18, 9], [98, 20], [17, 68],
    #  [37, 9], [60, 19], [93, 13], [27, 93], [80, 99], [73, 20], [49, 61], [66, 74], [58, 97], [13, 20], [27, 53],
    #  [99, 91], [5, 24], [62, 66], [77, 40], [77, 63], [80, 77], [51, 92], [49, 33], [66, 96], [77, 42], [18, 25],
    #  [35, 8], [49, 14], [20, 96], [81, 93], [3, 32], [39, 74], [42, 39], [11, 85], [8, 95], [96, 50], [49, 32],
    #  [92, 78], [68, 23], [34, 2], [69, 55], [13, 11], [24, 89], [45, 67], [92, 9], [23, 63], [8, 55], [9, 53], [16, 34],
    #  [88, 0], [11, 45], [80, 28], [96, 55], [88, 10], [91, 98], [1, 47], [15, 14], [85, 47], [90, 7], [30, 39],
    #  [30, 60], [94, 68], [54, 19], [22, 41], [10, 45], [57, 83], [6, 54], [1, 68], [14, 89], [11, 2], [48, 25],
    #  [50, 21], [74, 85], [86, 78], [91, 4], [3, 96], [85, 12], [69, 94], [66, 45], [80, 36], [81, 19], [83, 5],
    #  [41, 81], [4, 50], [37, 55], [81, 88], [20, 64], [78, 81], [61, 38], [42, 14], [85, 67], [74, 99], [52, 47],
    #  [87, 18], [5, 38], [43, 37], [34, 58], [41, 18], [26, 72], [48, 39], [63, 65], [91, 27], [7, 78], [17, 29],
    #  [85, 29], [49, 26], [100, 98], [60, 18], [11, 22], [58, 18], [43, 94], [11, 6], [42, 18], [79, 75], [51, 23],
    #  [69, 43], [7, 61], [28, 82], [61, 93], [77, 36], [32, 34], [58, 27], [46, 14], [95, 54], [47, 9], [52, 58],
    #  [29, 2], [75, 80], [14, 97], [75, 16], [37, 69], [71, 30], [26, 4], [18, 67], [33, 12], [24, 77], [27, 22],
    #  [28, 39], [92, 87], [5, 81], [88, 66], [25, 36], [33, 18], [28, 82], [62, 15], [74, 84], [23, 59], [99, 49],
    #  [72, 11], [10, 34], [8, 3], [8, 84], [96, 49], [34, 99], [18, 5], [44, 19], [54, 35], [56, 98], [97, 95], [20, 52],
    #  [54, 16], [8, 94], [85, 18], [23, 22], [99, 64], [7, 10], [57, 83], [81, 75], [1, 4], [42, 78], [35, 71], [96, 89]]
    # angle = 248
    # location = [7, 12]

    # points = [[68, 67], [20, 86], [0, 43], [50, 88], [44, 86], [89, 79], [2, 83], [55, 74], [13, 25], [86, 100], [48, 28],
    #  [74, 49], [67, 70], [90, 65], [74, 80], [92, 38], [26, 64], [56, 24], [58, 67], [55, 75], [7, 33], [90, 94],
    #  [33, 51], [40, 71], [17, 51], [38, 27], [11, 27], [39, 5], [73, 87], [78, 69], [82, 19], [85, 80], [69, 47],
    #  [17, 69], [1, 50], [84, 87], [91, 67], [67, 52], [71, 70], [35, 83], [4, 28], [9, 42], [77, 31], [26, 32],
    #  [68, 81], [40, 10], [53, 2], [85, 72], [79, 13], [98, 29], [8, 18], [91, 53], [93, 16], [29, 54], [24, 79],
    #  [26, 46], [45, 64], [95, 31], [22, 88], [12, 8], [61, 10], [85, 55], [60, 56], [31, 60], [54, 89], [42, 65],
    #  [94, 10], [70, 30], [67, 36], [63, 0], [50, 33], [14, 82], [66, 87], [38, 98], [82, 52], [44, 16], [22, 39],
    #  [34, 47], [87, 46], [90, 91], [41, 33], [96, 46], [96, 15], [45, 1], [21, 4], [1, 24], [79, 42], [36, 38], [6, 27],
    #  [38, 12], [63, 23], [3, 23], [18, 11], [76, 22], [17, 82], [57, 39], [85, 6], [93, 91], [73, 58], [68, 87],
    #  [84, 67], [63, 25], [37, 9], [91, 61], [83, 6], [59, 48], [76, 57], [68, 51], [62, 83], [72, 90], [51, 79],
    #  [69, 57], [65, 20], [69, 43], [28, 89], [40, 6], [21, 37], [64, 10], [7, 69], [95, 64], [82, 4], [25, 43],
    #  [97, 82], [12, 42], [96, 19], [85, 71], [78, 36], [97, 44], [65, 83], [15, 47], [79, 17], [85, 69], [26, 26],
    #  [30, 48], [74, 2], [43, 74], [17, 35], [49, 3], [74, 3], [40, 9], [32, 45], [82, 78], [66, 83], [47, 18], [17, 42],
    #  [100, 56], [73, 68], [62, 96], [57, 7], [0, 14], [66, 48], [54, 23], [59, 36], [37, 29], [95, 46], [11, 82],
    #  [50, 95], [55, 80], [57, 82], [8, 72], [89, 56], [21, 74], [86, 4], [28, 1], [31, 95], [68, 43], [73, 71],
    #  [27, 60], [32, 50], [38, 85], [94, 61], [44, 83], [29, 97], [69, 69], [6, 80], [16, 6], [95, 68], [82, 61],
    #  [80, 74], [17, 62], [70, 60], [97, 60], [48, 16], [84, 86], [34, 54], [51, 2], [87, 63], [85, 25], [44, 81],
    #  [25, 91], [51, 67], [1, 89], [21, 10], [87, 28], [73, 50], [26, 34], [84, 71], [6, 15], [64, 19], [24, 28],
    #  [95, 47], [41, 38], [9, 85], [60, 88], [32, 13], [37, 92], [49, 83], [100, 98], [15, 66], [1, 63], [26, 6],
    #  [15, 85], [29, 78], [0, 8], [39, 42], [62, 21], [98, 73], [18, 84], [73, 4], [99, 80], [4, 14], [34, 80], [13, 96],
    #  [22, 66], [35, 44], [68, 64], [24, 6], [64, 76], [5, 80], [85, 2], [4, 78], [90, 45], [9, 96], [76, 46], [56, 27],
    #  [27, 35], [87, 80], [75, 70], [58, 7], [42, 55], [27, 21], [55, 2], [96, 70], [92, 32], [51, 93], [76, 25],
    #  [55, 58], [55, 66], [96, 84], [38, 57], [92, 18], [97, 12], [79, 60], [30, 54], [44, 100], [1, 48], [90, 69],
    #  [35, 63], [55, 49], [60, 18], [69, 31], [24, 53], [61, 15], [92, 76], [62, 86], [31, 10], [48, 88], [12, 44],
    #  [15, 32], [14, 28], [53, 14], [36, 2], [41, 9], [100, 44], [92, 24], [86, 87], [46, 5], [75, 40], [83, 80],
    #  [79, 58], [40, 94], [27, 72], [24, 41], [29, 34], [46, 60], [70, 41], [21, 16], [39, 34], [3, 8], [8, 30],
    #  [75, 79], [3, 74], [39, 0], [86, 89], [44, 55], [86, 81], [33, 10], [0, 75], [77, 34], [40, 1], [39, 94], [29, 44],
    #  [62, 1], [99, 17], [39, 28], [69, 2], [86, 45], [40, 81], [100, 32], [72, 66], [34, 28], [14, 49], [56, 92],
    #  [76, 72], [64, 73], [6, 64], [64, 35], [8, 17], [36, 85], [51, 82], [34, 46], [16, 35], [94, 60], [43, 87],
    #  [98, 84], [84, 80], [71, 24], [95, 58], [2, 69], [52, 50], [43, 91], [58, 14], [53, 72], [66, 5], [89, 57],
    #  [1, 22], [90, 15], [10, 91], [97, 30], [100, 97], [51, 1], [0, 55], [87, 100], [27, 0], [16, 59], [60, 1],
    #  [35, 92], [43, 95], [81, 13], [83, 47], [29, 38], [51, 43], [23, 41], [11, 32], [33, 82], [35, 14], [58, 3],
    #  [0, 54], [70, 93], [33, 2], [50, 64], [83, 25], [65, 19], [87, 71], [21, 89], [21, 18], [86, 65], [73, 98],
    #  [85, 1], [91, 46], [38, 99], [71, 89], [92, 80], [47, 16], [79, 56], [24, 12], [2, 89], [62, 23], [71, 77],
    #  [43, 55], [31, 30], [56, 33], [32, 26], [28, 56], [14, 26], [88, 21], [100, 11], [84, 5], [26, 40], [35, 49],
    #  [87, 58], [2, 97], [50, 91], [3, 50], [78, 59], [86, 71], [99, 20], [40, 21], [12, 78], [49, 96], [42, 70],
    #  [7, 45], [71, 21], [24, 38], [22, 86], [98, 43], [20, 62], [87, 67], [81, 22], [26, 44], [96, 88], [30, 25],
    #  [81, 48], [75, 5], [65, 71], [50, 86], [72, 26], [46, 87], [69, 23], [12, 65], [19, 89], [14, 72], [69, 16],
    #  [66, 56], [53, 86], [74, 5], [90, 3], [13, 38], [70, 87], [0, 73], [67, 96], [48, 53], [9, 12], [88, 81], [10, 45],
    #  [68, 1], [48, 78], [19, 90], [99, 2], [4, 25], [82, 11], [86, 30], [81, 2], [18, 30], [15, 14], [75, 43], [50, 90],
    #  [5, 30], [74, 99], [24, 88], [67, 78], [77, 25], [14, 12], [50, 73], [27, 6], [53, 5], [89, 34], [84, 29], [3, 38],
    #  [82, 42], [5, 11], [17, 1], [85, 62], [30, 89], [83, 17], [85, 43], [18, 62], [80, 53], [19, 17], [77, 30],
    #  [84, 96], [68, 84], [7, 49], [92, 56], [8, 67], [0, 79], [54, 80], [1, 59], [14, 1], [31, 54], [9, 3], [49, 81],
    #  [23, 35], [32, 34], [88, 36], [43, 11], [31, 72], [10, 51], [51, 22], [65, 50], [41, 24], [42, 61], [64, 98],
    #  [88, 35], [87, 74], [66, 78], [92, 92], [90, 20], [6, 99], [84, 79], [2, 1], [48, 64], [88, 52], [28, 30],
    #  [36, 78], [95, 41], [8, 99], [46, 97], [74, 71], [87, 32], [82, 50], [27, 18], [47, 96], [43, 92], [67, 2],
    #  [70, 10], [10, 44], [26, 92], [49, 88], [95, 49], [6, 61], [93, 74], [51, 55], [23, 37], [21, 90], [66, 72],
    #  [12, 80], [65, 90], [60, 87], [14, 51], [83, 72], [67, 11], [64, 100], [4, 65], [76, 52], [14, 94], [75, 28],
    #  [80, 12], [45, 96], [30, 75], [12, 28], [52, 17], [56, 83], [21, 2], [60, 89], [43, 82], [28, 50], [75, 80],
    #  [34, 43], [37, 81], [18, 79], [72, 40], [54, 79], [7, 60], [88, 61], [41, 72], [97, 17], [56, 75], [75, 7],
    #  [13, 90], [64, 48], [12, 38], [50, 30], [85, 85], [3, 55], [3, 49], [69, 96], [21, 52], [80, 34], [50, 55],
    #  [24, 10], [4, 18], [98, 51], [5, 76], [97, 67], [64, 13], [5, 41], [1, 26], [39, 90], [64, 65], [47, 11], [98, 98],
    #  [23, 96], [90, 27], [32, 11], [82, 15], [25, 44], [26, 43], [44, 22], [71, 73], [100, 14], [68, 36], [19, 82],
    #  [96, 57], [63, 79], [39, 26], [36, 4], [8, 3], [19, 29], [46, 38], [58, 54], [51, 24], [56, 50], [67, 28],
    #  [17, 28], [64, 33], [88, 37], [6, 55], [8, 71], [28, 69], [97, 13], [64, 28], [60, 22], [11, 65], [32, 83],
    #  [47, 0], [89, 52], [34, 13], [8, 24], [1, 90], [10, 82], [4, 61], [95, 89], [46, 14], [5, 63], [67, 67], [1, 61],
    #  [90, 11], [26, 95], [89, 66], [67, 53], [92, 63], [61, 12], [59, 73], [25, 56], [30, 88], [70, 33], [84, 2],
    #  [53, 73], [93, 65], [36, 36], [56, 1], [59, 19], [34, 27], [12, 63], [2, 91], [52, 27], [1, 97], [52, 22],
    #  [31, 93], [19, 5], [88, 31], [44, 89], [48, 41], [84, 6], [2, 68], [31, 45], [65, 67], [85, 45], [11, 42],
    #  [39, 81], [79, 54], [71, 86], [80, 65], [60, 17], [93, 32], [42, 7], [46, 96], [94, 15], [35, 10], [26, 65],
    #  [45, 66], [85, 38], [78, 38], [64, 22], [0, 86], [35, 48], [37, 56], [68, 0], [19, 37], [29, 22], [73, 73],
    #  [90, 64], [21, 32], [7, 66], [69, 60], [37, 12], [7, 67], [9, 22], [40, 29], [37, 46], [16, 23], [49, 67],
    #  [50, 24], [49, 18], [64, 68], [98, 63], [65, 89], [93, 73], [76, 50], [75, 46], [48, 27], [69, 79], [20, 15],
    #  [59, 53], [30, 95], [47, 23], [36, 6], [28, 87], [88, 59], [72, 23], [75, 41], [50, 78], [36, 5], [6, 28],
    #  [89, 48], [19, 14], [58, 73], [36, 97], [81, 58], [100, 4], [79, 67], [6, 59], [30, 96], [28, 22], [59, 32],
    #  [15, 92], [51, 21], [30, 62], [98, 49], [3, 7], [98, 26], [53, 11]]
    # angle = 36
    # location = [57, 39]
    print(solution.visiblePoints(points, angle, location))

